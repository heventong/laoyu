!function(f){function y(e,a){var d=a||f.location.search,t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),r=d.substr(d.indexOf("?")+1).match(t);return null!=r?r[2]:""}function w(){var e="";if(window.OppoWebPage&&window.OppoWebPage.getBrand&&window.OppoWebPage.getBrand())e=window.OppoWebPage.getBrand().toUpperCase();else if(window.AndroidInterface&&-1!==navigator.userAgent.indexOf("pictorial_version")){var a=/channel\/([\w.]+)/gi.exec(navigator.userAgent);e=a?a[1].toUpperCase():""}return e}if(f.HTMLElement.prototype.parents=function(e){var a=this;return a.attributes[e]?a:(a=a.parentNode)&&"html"!==a.nodeName.toLowerCase()?a.parents(e):null},f.HTMLElement.prototype.attr=function(e){return this.attributes[e]?this.attributes[e].value:null},f.HTMLElement.prototype.getAdvDatas=function(){return{advId:this.attr("adv-id")||"",advPos:this.attr("adv-pos")||"",advPkg:this.attr("adv-pkg")||"",advPassthrough:this.attr("adv-passthrough")||"",advRole:this.attr("adv-role")||"",advAction:this.attr("adv-action")||"",advAppId:this.attr("adv-appid")||"",darea:this.attr("adv-darea")||"",advMainPkg:this.attr("adv-mainpkg"),repeat:this.attr("adv-repeat")||"",platform:this.attr("adv-platform")||f._adv.platform||"",targetUrl:this.attr("adv-target")||"",crtId:this.attr("adv-crtId")||""}},f._adv||(f._adv={platform:"adx"}),f.OppoWebPage)try{var e="";f.OppoWebPage.getBrowserInfo&&(e=f.OppoWebPage.getBrowserInfo()),!e&&f.OppoWebPage.getCommonBrowserInfo&&(e=f.OppoWebPage.getCommonBrowserInfo()),e&&(a=(a=JSON.parse(e))||{},f._adv.imei=a.imei||a.uuid||"",f._adv.model=a.mobileName||"",f._adv.osVersion=a.colorOsVersion||"",f._adv.romVersion=a.mobileRomVersion||"",f._adv.androidVersion=a.androidReleaseVersion||"",f._adv.appVersion=a.browserVersion||"",f._adv.networkId=a.networkType||"")}catch(e){}var a;if("feeds"===window._adv.platform){var d=y("im");if(d)window._adv.imei="__"+decodeURIComponent(d);else if(window.OppoWebPage&&window.OppoWebPage.getCommonBrowserInfo)try{var t=JSON.parse(window.OppoWebPage.getCommonBrowserInfo());window._adv.imei=t.uuid}catch(e){}}function r(){this.domain="https://data.ads.oppomobile.com/",this.iframeLoaded=!1,this.parModuleId=f._adv.parModuleId||"",this.parPosId=y("parposid")||f._adv.parPosId||"",this.exposureArray=[],this.downArray=[],this.clickArray=[],this.events={feeds:{show:"feeds-hpv",click:"feeds-hclk",expose:"feeds-hexp","show-key":"a,b,c,adposId,categoryId,d,e,parPosId,evtId,g,adId,adType,h,grade,adOwner,contentId,contentCls,contentSize,oprObj,planId,parEvtId,traceId,abtest,property,displayTime,price2,chargeAccId","click-key":"a,b,c,adposId,categoryId,d,e,f,evtId,dayNums,adId,adType,price,grade,adOwner,contentId,contentCls,contentSize,oprObj,planId,parEvtId,traceId,abtest,property,displayTime,price2,chargeAccId,pTraceId,adSource,clickType","expose-key":"a,b,oPosId,adposId,categoryId,d,e,parPosId,evtId,g,adId,adType,h,grade,adOwner,contentId,contentCls,contentSize,oprObj,planId,parEvtId,traceId,abtest,property,displayTime,pTraceId,adSource,adGroupId,rTraceId,mediaId,brand"},"cpd-app":{show:"cpd-app-hpv",click:"adx-hclk",down:"cpd-app-hdown",expose:"cpd-app-hexp","show-key":"adposId,evtId,parEvtId,traceId,modId,abtest,sprd","click-key":"oprObj,oPosId,adposId,evtId,traceId,abtest,posSrc,optc,crtId","down-key":"oprObj,b,c,parModuleId,e,f,sTagId,adposId,planId,adId,adType,adOwner,contentId,categoryId,h,discount,dayNums,abtest,evtId,parEvtId,traceId,sex,age,modId","expose-key":"oprObj,b,c,d,e,f,sTagId,adposId,planId,adId,adType,adOwner,contentId,categoryId,h,discount,dayNums,abtest,evtId,parEvtId,t,sex,age,modId"},adx:{show:"adx-hpv",click:"adx-hclk",expose:"adx-hexp","show-key":"oprObj,oPosId,adposId,evtId,traceId,abtest,posSrc,crtId,domain","click-key":"oprObj,oPosId,adposId,evtId,traceId,abtest,posSrc,optc,crtId,pTraceId,domain,adId,adOwner","expose-key":"oprObj,oPosId,adposId,evtId,traceId,abtest,posSrc,optc,crtId,pTraceId,domain"},act:{show:"act-pv",click:"act-click",expose:"act-expose","show-key":"a,b,c,d,e,traceId,sTagId,actId,evtId,abtest","click-key":"a,reqId,sTagId,actId,mdId,pId,adId,ownId,adposid,cst,cnt,adAppId,price,traceId,abtest,parEvtId,evtId,dealSrc,dealRs,chk,darea,carea,clsBhv","expose-key":"a,reqId,sTagId,actId,mdId,pId,adId,ownId,adposid,cst,cnt,adAppId,traceId,abtest,parEvtId,evtId"},bs:{down:"bs-js-down","down-key":"contentId,pkg,adposId,kw,keyword,planId,adId,adType,parEvtId,traceId,sc,parModuleId,accId,price2,flag,chn,isAd,isOut,optKey,optValue,lable"},lm:{show:"lm-hpv",click:"lm-hclk",expose:"lm-hexpr","show-key":"a,b,c,d,e,f,evtId,posId,as,respid,traceId,lmchn,tmpId,adCat,aProt,lpu","click-key":"a,b,c,d,e,f,evtId,posId,as,respId,pTraceId,adposId,lmchn,adOwner,adId,tmpId,adCat,dspAdIdFlag,actSource,aProt,prmtId,lpu,mPF,smbTS,labid,costType,ocpcType,ocpcBid,parEvtId,valid,oprEnv,userTag,tmpCId,posType,extFiled,cheatResponse,experIds,stgyIds,extInfo,ptraceIdno,tkRef,tkId","expose-key":"a,b,c,d,e,f,evtId,posId,as,respId,pTraceId,lmchn,adOwner,adId,tmpId,adCat,aProt,lpu,tmpCId,cheatResponse,smbTs,extInfo,ptraceIdno,tkRef,tkId"},sms:{show:"sms-hpv",click:"sms-hclk",expose:"sms-hexp","show-key":"source,sTagId","click-key":"source,sTagId,adId,url,lat,lgt","expose-key":"source,sTagId,adId,url,lat,lgt"},bd:{click:"bd-hclk",expose:"bd-hexp","click-key":"a,b,oPosId,adposId,categoryId,d,e,f,evtId,dayNums,adId,adType,h,grade,adOwner,contentId,contentCls,contentSize,oprObj,planId,parEvtId,traceId,abtest,labId,displayTime,price2,chargeAccId,pTraceId,bid,clickType","expose-key":"a,b,oPosId,adposId,categoryId,d,e,f,evtId,g,adId,adType,h,grade,adOwner,contentId,contentCls,contentSize,oprObj,planId,parEvtId,traceId,abtest,labId,displayTime,pTraceId"}},this.bindEvent(),this.createIframe()}r.prototype.bindEvent=function(){var p=this,a=null;document.body.addEventListener("touchend",function(e){a&&window.clearTimeout(a),a=setTimeout(function(){p.checkExposure()},300)}),document.body.addEventListener("click",function(e){var a=e.target,d=a.parents("adv-id");if(d){var t=a.parents("statistics-down"),r=a.parents("statistics-click"),o=d.getAdvDatas(),s=o.advId+"&&"+o.advPos;t&&s&&p.iframeLoaded&&(-1==p.downArray.indexOf(s)||"1"==o.repeat)&&(-1==p.downArray.indexOf(s)&&p.downArray.push(s),p.report("down",o)),r&&s&&p.iframeLoaded&&(-1==p.clickArray.indexOf(s)||"1"==o.repeat)&&(-1==p.clickArray.indexOf(s)&&p.clickArray.push(s),"feeds"==o.platform?p.feedsCharge("click",o):p.report("click",o))}})},r.prototype.triggerDown=function(e){var a=this,d=(e=e||{}).advId+"&&"+e.advPos;a.iframeLoaded?-1!=a.downArray.indexOf(d)&&"1"!=e.repeat||(a.downArray.push(d),a.report("down",e)):setTimeout(function(){a.triggerDown.call(a,e)},50)},r.prototype.triggerClick=function(e){(e=e||{}).platform=e.platform||f._adv.platform;var a=this,d=e.advId+"&&"+e.advPos;a.iframeLoaded?-1!=a.clickArray.indexOf(d)&&"1"!=e.repeat||(a.clickArray.push(d),"feeds"==e.platform?a.feedsCharge("click",e):a.report("click",e)):setTimeout(function(){a.triggerClick.call(a,e)},50)},r.prototype.createIframe=function(){var e=this,a=document.createElement("iframe");a.src=e.domain+"h5/adv.html?v=20171214",a.name="pipe",a.style.display="none",document.body.appendChild(a),a.onload=function(){e.iframeLoaded=!0,e.report("show"),setTimeout(function(){e.checkExposure()},500)},setTimeout(function(){e.iframeLoaded||e.createIframe()},3e3)},r.prototype.feedsCharge=function(e,a){var d=[],t={},r=1===a.advAction&&"click-begin"===a.tabId?"feeds-expose-z":this.events[a.platform][e],o="adId,adType,price,grade,adOwner,contentId,contentCls,contentSize,oprObj,planId,parEvtId,traceId,abtest,property,displayTime,pTraceId,adSource,adGroupId,rTraceId,mediaId,brand,openAdId".split(","),s=["imei","model","brand","osVersion","romVersion","androidVersion","channel","systemId","appVersion","networkId","clientTime","dataType","eventValue"];for(var p in f._adv)-1!==s.indexOf(p)&&(t[p]=f._adv[p]);t.clientTime=(new Date).getTime(),t.posId=a.advPos,t.dataType=r,t.evtId=(new Date).getTime(),t.adId=a.advId||y("transparent").split("_")[0]||0,t.enterId=a.enterId||"",t.eventValue=a.advAction||2,t.parPosId=y("parposid"),t.tabId=a.tabId||"";for(var n=0;n<o.length;++n)"pTraceId"==o[n]?d.push(decodeURIComponent(y("tid"))):"contentId"==o[n]?d.push(a.advPkg||""):"rTraceId"===o[n]?d.push(y("rtid")||""):"brand"===o[n]?d.push(w()):"property"===o[n]?d.push(decodeURIComponent(y("lbid"))):"adOwner"===o[n]?d.push(y("transparent").split("_")[1]||""):d.push("");t.transparent=a.advPassthrough||d.join(","),f.frames.pipe.postMessage(JSON.stringify({methodName:"uploadClickData2",arguments:[t]}),this.domain)},r.prototype.checkExposure=function(){for(var e=document.querySelectorAll("*[statistics-expose]"),a=0,d=e.length;a<d;++a){var t=e[a],r=t.getAdvDatas(),o=r.advId+"&&"+r.advPos,s=t.getBoundingClientRect(),p=s.height/2+f.innerHeight;this.iframeLoaded&&0<s.height&&s.bottom<=p&&-1==this.exposureArray.indexOf(o)&&(this.exposureArray.push(o),this.report("expose",r))}},r.prototype.report=function(a,e){var d=[],t={},r=(e=e||{}).platform||f._adv.platform,o=this.events[r][a];if(o){try{e.advPassthrough&&(t=JSON.parse(e.advPassthrough))}catch(e){t={}}var s=this.events[r][a+"-key"].split(","),p=f._adv.imei;!p&&t.imei&&(p=t.imei);for(var n=[p,f._adv.guId||"",f._adv.model,f._adv.osVersion,f._adv.romVersion,f._adv.androidVersion,f._adv.sdkVersion,f._adv.channel||"",f._adv.systemId||"",f._adv.ouId||"",f._adv.appVersion,f._adv.networkId].join("\t")+"\t"+(new Date).getTime()+"\t"+(f._adv.duId||"")+"\t\t"+o+"\t0\t1\t",c=0;c<s.length;c++){switch(s[c].toLowerCase()){case"parmoduleid":d.push(this.parModuleId);break;case"parposid":case"paradposid":d.push(this.parPosId);break;case"adowner":d.push(m());break;case"traceid":d.push(I());break;case"evtid":d.push((new Date).getTime());break;case"parevtid":d.push(h());break;case"adposid":d.push(e.advPos||"");break;case"adid":d.push(b());break;case"ptraceid":d.push(decodeURIComponent(y("tid")));break;case"modid":d.push(l());break;case"oprobj":d.push(u());break;case"carea":d.push(e.advRole||"");break;case"b":d.push(e.advMainPkg||"");break;case"optc":case"clsbhv":case"clicktype":case"e":d.push(e.advAction||"");break;case"adappid":case"contentid":d.push(e.advAppId||t.contentId||e.advPkg||"");break;case"rtraceid":d.push(y("rtid")||"");break;case"brand":d.push(w());break;case"stagid":d.push(y("sTag")||f._adv.sTag||"");break;case"actid":d.push(t.actId||y("_actId")||"");break;case"darea":d.push(e.darea||"");break;case"optvalue":d.push(1==e.advAction?6:4);break;case"optkey":d.push("btn");break;case"posid":d.push(y("ps"));break;case"as":d.push(y("as"));break;case"respid":d.push(y("rq"));break;case"lmchn":d.push(decodeURIComponent(y("chn")));break;case"tmpid":d.push(f._adv&&f._adv.tmpId||"");break;case"adcat":d.push(y("adCat"));break;case"dspadidflag":d.push(y("daid"));break;case"aprot":d.push(y("aProt"));break;case"prmtid":d.push(y("ptd"));break;case"lpu":d.push(y("lpu"));break;case"oprenv":d.push(g());break;case"smbts":d.push(y("smbTS"));break;case"possrc":d.push(v());break;case"crtid":d.push(e.crtId);break;case"domain":d.push(f.location.host);break;case"source":d.push(f._adv.source||35);break;case"url":d.push(e.targetUrl);break;case"lat":d.push(f._adv.lat||"");break;case"lgt":d.push(f._adv.lgt||"");break;default:d.push(t[s[c]]||"")}}n+=d.join(",");var i=[{headers:{evtTime:(new Date).getTime(),dataType:o,evtId:""},body:n}];"lm"===r&&(i[0].headers.apiSmbTs=y("apiSmbTs")),f.frames.pipe.postMessage(JSON.stringify(i),this.domain)}function I(){return"show"==a?decodeURIComponent(y("tid"))||f.sessionStorage.getItem("tid"):t.traceId}function h(){return"show"==a?f.sessionStorage.getItem("parEvtId"):t.parEvtId}function l(){var e=t.modId;return e||(e="show"==a?y("module")||f.sessionStorage.getItem("moduleId"):y("module")),e}function u(){return"show"==a?decodeURIComponent(y("pkg")).trim():e.advPkg}function v(){var e=f._adv.posSrc;return e||(e=y("posSrc")||"9000"),e}function m(){return"lm-hclk"==o||"lm-hexpr"==o?y("ow")||t.adOwner||0:t.adOwner||k(1)||0}function b(){return"lm-hclk"==o||"lm-hexpr"==o?y("aid")||e.advId||t.adId||"":e.advId||t.adId||k(0)}function k(e){return y("transparent").split("_")[e]||""}function g(){return f.android&&f.android.getDeviceInfo?1:f.OppoWebPage&&f.OppoWebPage.getBrowserInfo?0:""}},f.reporter=new r}(window);